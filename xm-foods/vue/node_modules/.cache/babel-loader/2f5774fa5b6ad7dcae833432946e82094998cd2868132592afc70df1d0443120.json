{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Footer from \"@/components/Footer\";\nexport default {\n  name: \"FoodDetail\",\n  components: {\n    Footer\n  },\n  data() {\n    return {\n      id: this.$route.query.id,\n      // 菜谱ID\n      foods: {},\n      materialList: [],\n      stepList: [],\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\n      commentCount: 0\n    };\n  },\n  created() {\n    this.updateCount();\n  },\n  methods: {\n    updateCount() {\n      this.$request.put('/foods/updateCount/' + this.id).then(res => {\n        this.load();\n      });\n    },\n    collect() {\n      this.$request.post('/collect/set', {\n        fid: this.id,\n        userId: this.user.id,\n        module: \"菜谱\"\n      }).then(res => {\n        if (res.code === '200') {\n          this.$message.success('操作成功');\n          this.load();\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    load() {\n      this.$request.get('/foods/selectById/' + this.id).then(res => {\n        this.foods = res.data || {};\n        this.materialList = JSON.parse(this.foods?.material || '[]');\n        this.stepList = JSON.parse(this.foods?.steps || '[]');\n        if (this.materialList.length && this.materialList.length % 2 !== 0) {\n          // this.materialList.length % 2 !== 0\n          this.materialList.push({});\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["Footer","name","components","data","id","$route","query","foods","materialList","stepList","user","JSON","parse","localStorage","getItem","commentCount","created","updateCount","methods","$request","put","then","res","load","collect","post","fid","userId","module","code","$message","success","error","msg","get","material","steps","length","push"],"sources":["src/views/front/FoodDetail.vue"],"sourcesContent":["<template>\r\n  <div class=\"main-content\" style=\"width: 50%\">\r\n    <img :src=\"foods.cover\" alt=\"\" style=\"width: 70%;  border-radius: 5px\">\r\n    <div style=\"margin: 20px 0; font-size: 22px; font-weight: bold\">{{ foods.name }}</div>\r\n    <div style=\"display: flex; margin-bottom: 30px\">\r\n      <div style=\"display: flex; align-items: center; flex: 1\">\r\n        <img :src=\"foods.avatar\" alt=\"\" style=\"width: 30px; height: 30px; border-radius: 50%\">\r\n        <span style=\"margin-left: 5px\">{{ foods.userName }}</span>\r\n      </div>\r\n      <div style=\"flex: 1; display: flex; align-items: center; justify-content: flex-end\">\r\n        <span style=\"font-size: 20px; color: orange; font-weight: bold; margin-right: 2px\">{{ foods.count }}</span> 浏览\r\n        <span style=\"font-size: 20px; color: orange; font-weight: bold; margin-right: 2px; margin-left: 30px\">{{ foods.collectCount }}</span> 收藏\r\n        <el-button icon=\"el-icon-star-on\" style=\"margin-left: 30px; color: orange\" v-if=\"foods.userCollect\" @click=\"collect\">已收藏</el-button>\r\n        <el-button icon=\"el-icon-star-off\" style=\"margin-left: 30px\" v-else @click=\"collect\">收藏</el-button>\r\n      </div>\r\n    </div>\r\n\r\n    <div style=\"font-size: 14px; color: #666; line-height: 24px; margin: 30px 0\">{{ foods.descr }}</div>\r\n\r\n    <div style=\"margin: 30px 0\">\r\n      <div style=\"margin: 20px 0; font-size: 22px; font-weight: bold\">{{ foods.name }}的原料</div>\r\n      <div style=\"display: flex; flex-wrap: wrap; background-color: #e9ffe2\">\r\n        <div v-for=\"(item, index) in materialList\" :key=\"index\" style=\"display: flex; padding: 10px; width: 50%;\"\r\n             :class=\"{ 'bt' : index !== materialList.length - 1 && index !== materialList.length - 2, 'br' : index % 2 === 0 }\">\r\n          <div style=\"flex: 1\">{{ item.name }}</div>\r\n          <div>{{ item.value }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n\r\n    <div style=\"margin: 30px 0\">\r\n      <div style=\"margin: 20px 0; font-size: 22px; font-weight: bold\">{{ foods.name }}的做法</div>\r\n      <div style=\"display: flex; margin-bottom: 10px\" v-for=\"(item, index) in stepList\" :key=\"index\">\r\n        <img :src=\"item.img\" style=\"width: 100px; height: 100px\">\r\n        <div style=\"padding-left: 10px\">\r\n          <div style=\"font-size: 18px; font-weight: bold; margin-bottom: 10px\">步骤 {{ index + 1 }}</div>\r\n          <div>{{ item.text }}</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div style=\"margin: 30px 0\">\r\n      <div style=\"margin: 20px 0; font-size: 22px; font-weight: bold\">{{foods.name}}的技巧</div>\r\n      <div>{{foods.skills}}</div>\r\n    </div>\r\n    <div style=\"margin: 30px 0; color: #666; font-size: 12px\">\r\n      发布时间：{{foods.time}}\r\n    </div>\r\n\r\n    <div style=\"margin: 30px 0;\">\r\n      <div style=\"margin-bottom: 20px; font-size: 22px; font-weight: bold\">评论{{commentCount}}</div>\r\n    </div>\r\n\r\n    <Footer />\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Footer from \"@/components/Footer\";\r\nexport default {\r\n  name: \"FoodDetail\",\r\n  components: {Footer},\r\n  data() {\r\n    return {\r\n      id: this.$route.query.id,  // 菜谱ID\r\n      foods: {},\r\n      materialList: [],\r\n      stepList: [],\r\n      user: JSON.parse(localStorage.getItem('xm-user') || '{}'),\r\n      commentCount:0\r\n    }\r\n  },\r\n  created() {\r\n    this.updateCount()\r\n  },\r\n  methods: {\r\n    updateCount(){\r\n      this.$request.put('/foods/updateCount/' + this.id).then(res => {\r\n        this.load()\r\n      })\r\n    },\r\n    collect(){\r\n      this.$request.post('/collect/set',{fid:this.id,userId: this.user.id, module: \"菜谱\"}).then(res =>{\r\n        if (res.code === '200') {\r\n          this.$message.success('操作成功')\r\n          this.load()\r\n        } else {\r\n          this.$message.error(res.msg)\r\n        }\r\n      })\r\n    },\r\n    load() {\r\n      this.$request.get('/foods/selectById/' + this.id).then(res => {\r\n        this.foods = res.data || {}\r\n        this.materialList = JSON.parse(this.foods?.material || '[]')\r\n        this.stepList = JSON.parse(this.foods?.steps || '[]')\r\n        if (this.materialList.length && this.materialList.length % 2 !== 0) {   // this.materialList.length % 2 !== 0\r\n          this.materialList.push({})\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.br {\r\n  border-right: 1px solid #ccc;\r\n}\r\n\r\n.bt {\r\n  border-bottom: 1px solid #ccc;\r\n}\r\n</style>"],"mappings":";AA2DA,OAAAA,MAAA;AACA;EACAC,IAAA;EACAC,UAAA;IAAAF;EAAA;EACAG,KAAA;IACA;MACAC,EAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAF,EAAA;MAAA;MACAG,KAAA;MACAC,YAAA;MACAC,QAAA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAC,YAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,WAAA;EACA;EACAC,OAAA;IACAD,YAAA;MACA,KAAAE,QAAA,CAAAC,GAAA,8BAAAhB,EAAA,EAAAiB,IAAA,CAAAC,GAAA;QACA,KAAAC,IAAA;MACA;IACA;IACAC,QAAA;MACA,KAAAL,QAAA,CAAAM,IAAA;QAAAC,GAAA,OAAAtB,EAAA;QAAAuB,MAAA,OAAAjB,IAAA,CAAAN,EAAA;QAAAwB,MAAA;MAAA,GAAAP,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAO,IAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACA,KAAAR,IAAA;QACA;UACA,KAAAO,QAAA,CAAAE,KAAA,CAAAV,GAAA,CAAAW,GAAA;QACA;MACA;IACA;IACAV,KAAA;MACA,KAAAJ,QAAA,CAAAe,GAAA,6BAAA9B,EAAA,EAAAiB,IAAA,CAAAC,GAAA;QACA,KAAAf,KAAA,GAAAe,GAAA,CAAAnB,IAAA;QACA,KAAAK,YAAA,GAAAG,IAAA,CAAAC,KAAA,MAAAL,KAAA,EAAA4B,QAAA;QACA,KAAA1B,QAAA,GAAAE,IAAA,CAAAC,KAAA,MAAAL,KAAA,EAAA6B,KAAA;QACA,SAAA5B,YAAA,CAAA6B,MAAA,SAAA7B,YAAA,CAAA6B,MAAA;UAAA;UACA,KAAA7B,YAAA,CAAA8B,IAAA;QACA;MACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}